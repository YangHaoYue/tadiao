(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-login-login"],{"1e34":function(t,e,o){var n=o("24fb");e=n(!1),e.push([t.i,".codeType[data-v-4ce67c50]{\n\t/* padding: 20rpx 10rpx; */border:#0f58fb solid %?1?%;border-radius:%?5?%;margin-left:%?10?%;color:#0f58fb}",""]),t.exports=e},6511:function(t,e,o){"use strict";o.r(e);var n=o("7cd4"),i=o("9372");for(var r in i)"default"!==r&&function(t){o.d(e,t,(function(){return i[t]}))}(r);o("b584");var a,s=o("f0c5"),u=Object(s["a"])(i["default"],n["b"],n["c"],!1,null,"4ce67c50",null,!1,n["a"],a);e["default"]=u.exports},"7cd4":function(t,e,o){"use strict";o.d(e,"b",(function(){return i})),o.d(e,"c",(function(){return r})),o.d(e,"a",(function(){return n}));var n={uForm:o("2704").default,uFormItem:o("ffe9").default,uInput:o("0ba7").default,uButton:o("05ab").default,uVerificationCode:o("7130").default,uToast:o("b3bf").default},i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-uni-view",{staticClass:"u-p-50"},[o("v-uni-view",{staticClass:"text-bold",staticStyle:{"font-size":"60rpx"}},[t._v("登录")]),o("v-uni-view",{staticClass:"text-gray u-font-36 u-m-b-20"},[t._v("登录后体验更精彩")]),o("u-form",{ref:"uForm",attrs:{model:t.model,rules:t.rules,errorType:t.errorType}},[o("u-form-item",{attrs:{"label-style":t.labelStyle,required:!0,"label-position":t.labelPosition,label:"手机",prop:"phone"}},[o("u-input",{attrs:{border:t.border,type:"number",placeholder:"请输入手机号"},model:{value:t.model.phone,callback:function(e){t.$set(t.model,"phone",e)},expression:"model.phone"}})],1),o("u-form-item",{attrs:{"label-style":t.labelStyle,required:!0,"label-position":t.labelPosition,label:"验证码",prop:"code","label-width":"150"}},[o("u-input",{attrs:{border:t.border,placeholder:"请输入验证码",type:"number"},model:{value:t.model.code,callback:function(e){t.$set(t.model,"code",e)},expression:"model.code"}}),o("u-button",{attrs:{slot:"right",type:"primary",plain:!0,size:"medium"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.getCode.apply(void 0,arguments)}},slot:"right"},[t._v(t._s(t.codeTips))])],1)],1),o("v-uni-navigator",{staticClass:"u-m-b-60 u-text-center u-m-t-60 u-text-right",attrs:{"open-type":"navigate",url:"register","hover-class":"none"}},[t._v("还没有账号?"),o("v-uni-text",{staticClass:"u-m-l-10",staticStyle:{color:"#0F58FB"}},[t._v("前去注册")])],1),o("u-button",{staticClass:"u-m-t-30",attrs:{type:"primary",disabled:t.disabled},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.submit.apply(void 0,arguments)}}},[t._v("登录")]),o("u-verification-code",{ref:"uCode",attrs:{seconds:"60"},on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.codeChange.apply(void 0,arguments)}}}),o("u-toast",{ref:"uToast"})],1)},r=[]},9372:function(t,e,o){"use strict";o.r(e);var n=o("a04b"),i=o.n(n);for(var r in n)"default"!==r&&function(t){o.d(e,t,(function(){return n[t]}))}(r);e["default"]=i.a},a04b:function(t,e,o){"use strict";o("4d63"),o("ac1f"),o("25f0"),o("466d"),o("841c"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={onLoad:function(t){var e=this.http.getToken(),o=uni.getStorageSync("identity");e&&(1==o?uni.switchTab({url:"../home/home"}):2==o||3==o?window.location.href="http://tower.0831.run/html/staff":4==o||5==o?window.location.href="http://tower.0831.run/html/manager":6==o&&(window.location.href="http://tower.0831.run/html/manager/#/pages/leader/index"))},onShow:function(){var t=this.GetQueryString("openid");this.GetQueryString("userid");null==t?this.getOpenid():(this.openid=t,uni.setStorageSync("openid",t))},data:function(){var t=this;return{openid:"",inviter_id:"",border:!1,labelStyle:{fontSize:"28rpx",fontWeight:"bold"},labelPosition:"top",codeTips:"",errorType:["message","border-bottom"],model:{phone:"",code:""},rules:{phone:[{required:!0,message:"请输入手机号",trigger:["change","blur"]},{validator:function(e,o,n){return t.$u.test.mobile(o)},message:"手机号码不正确",trigger:["change","blur"]}],code:[]}}},onReady:function(){this.$refs.uForm.setRules(this.rules)},computed:{disabled:function(){var t=!0;return this.model.phone&&this.model.code&&(t=!1),t}},methods:{getOpenid:function(){console.log("eee"),window.location.href=this.http.interfaceUrl()+"auth/oauth?action=0"},codeChange:function(t){this.codeTips=t},getCode:function(){var t=this;if(!this.model.phone)return this.$u.toast("请先输入手机号码!");this.$refs.uCode.canGetCode?(uni.showLoading({title:"正在获取验证码",mask:!0}),this.http.post("auth/sendMsgCode",{tel_num:this.model.phone}).then((function(e){1e3==e.code?(uni.hideLoading(),t.$u.toast("验证码已发送"),t.$refs.uCode.start()):t.$u.toast(e.msg)}))):this.$u.toast("倒计时结束后再发送")},submit:function(){var t=this;this.$refs.uForm.validate((function(e){e?t.http.post("auth/login",{tel_num:t.model.phone,msg_code:t.model.code}).then((function(e){1e3==e.code?(t.http.setUserInfo(e.data.token,e.data.identity,"",t.model.phone),1==e.data.identity?t.$refs.uToast.show({title:e.msg,type:"success",isTab:!0,url:"/pages/home/home"}):2==e.data.identity||3==e.data.identity?window.location.href="http://tower.0831.run/html/staff":4==e.data.identity||5==e.data.identity?window.location.href="http://tower.0831.run/html/manager":6==e.data.identity&&(window.location.href="http://tower.0831.run/html/manager/#/pages/leader/leader")):(t.$refs.uToast.show({title:e.msg,type:"error"}),"用户不存在"==e.msg&&setTimeout((function(){uni.navigateTo({url:"register"})}),1e3))})):t.$refs.uToast.show({title:"请填写完带*号的选项再提交",type:"error"})}))},GetQueryString:function(t){var e=new RegExp("(^|&)"+t+"=([^&]*)(&|$)"),o=window.location.search.substr(1).match(e);return null!=o?unescape(o[2]):null}}};e.default=n},a999:function(t,e,o){var n=o("1e34");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var i=o("4f06").default;i("2a831f36",n,!0,{sourceMap:!1,shadowMode:!1})},b584:function(t,e,o){"use strict";var n=o("a999"),i=o.n(n);i.a}}]);