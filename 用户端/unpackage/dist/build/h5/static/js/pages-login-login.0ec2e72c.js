(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-login-login"],{"25c8":function(e,t,o){var n=o("af0e");"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var i=o("4f06").default;i("719ae050",n,!0,{sourceMap:!1,shadowMode:!1})},"39f1":function(e,t,o){"use strict";o.r(t);var n=o("85d7"),i=o("66ed");for(var a in i)"default"!==a&&function(e){o.d(t,e,(function(){return i[e]}))}(a);o("ff65");var r,s=o("f0c5"),d=Object(s["a"])(i["default"],n["b"],n["c"],!1,null,"03b14faa",null,!1,n["a"],r);t["default"]=d.exports},"66ed":function(e,t,o){"use strict";o.r(t);var n=o("da29"),i=o.n(n);for(var a in n)"default"!==a&&function(e){o.d(t,e,(function(){return n[e]}))}(a);t["default"]=i.a},"85d7":function(e,t,o){"use strict";o.d(t,"b",(function(){return i})),o.d(t,"c",(function(){return a})),o.d(t,"a",(function(){return n}));var n={uForm:o("aae3").default,uFormItem:o("4ac9").default,uInput:o("4b1d").default,uButton:o("6aa6").default,uVerificationCode:o("558b").default,uToast:o("fac8").default},i=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("v-uni-view",{staticClass:"u-p-50"},[o("v-uni-view",{staticClass:"text-bold",staticStyle:{"font-size":"60rpx"}},[e._v("登录")]),o("v-uni-view",{staticClass:"text-gray u-font-36 u-m-b-20"},[e._v("登录后体验更精彩")]),o("u-form",{ref:"uForm",attrs:{model:e.model,rules:e.rules,errorType:e.errorType}},[o("u-form-item",{attrs:{"label-style":e.labelStyle,required:!0,"label-position":e.labelPosition,label:"手机",prop:"phone"}},[o("u-input",{attrs:{border:e.border,type:"number",placeholder:"请输入手机号"},model:{value:e.model.phone,callback:function(t){e.$set(e.model,"phone",t)},expression:"model.phone"}})],1),o("u-form-item",{attrs:{"label-style":e.labelStyle,required:!0,"label-position":e.labelPosition,label:"验证码",prop:"code","label-width":"150"}},[o("u-input",{attrs:{border:e.border,placeholder:"请输入验证码",type:"number"},model:{value:e.model.code,callback:function(t){e.$set(e.model,"code",t)},expression:"model.code"}}),o("u-button",{attrs:{slot:"right",type:"primary",plain:!0,size:"medium"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.getCode.apply(void 0,arguments)}},slot:"right"},[e._v(e._s(e.codeTips))])],1)],1),o("u-button",{staticClass:"u-m-t-30",attrs:{type:"primary",disabled:e.disabled},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.submit.apply(void 0,arguments)}}},[e._v("登录")]),o("u-verification-code",{ref:"uCode",attrs:{seconds:"60"},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.codeChange.apply(void 0,arguments)}}}),o("u-toast",{ref:"uToast"})],1)},a=[]},af0e:function(e,t,o){var n=o("24fb");t=n(!1),t.push([e.i,".codeType[data-v-03b14faa]{\n\t/* padding: 20rpx 10rpx; */border:#0f58fb solid %?1?%;border-radius:%?5?%;margin-left:%?10?%;color:#0f58fb}",""]),e.exports=t},da29:function(e,t,o){"use strict";o("a9e3"),o("4d63"),o("ac1f"),o("25f0"),o("466d"),o("841c"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n={onLoad:function(e){var t=this.http.getToken(),o=Number(uni.getStorageSync("identity"));t&&(console.log(o),1===o?uni.switchTab({url:"../home/home"}):2===o||3===o?window.location.href=this.http.navUrl()+"staff":4===o||5===o?window.location.href=this.http.navUrl()+"manager":6===o&&(window.location.href=this.http.navUrl()+"manager/#/pages/leader/index?"+this.$u.random(1,100)))},onShow:function(){uni.showLoading({mask:!0,title:"正在加载请稍后..."});var e=this.GetQueryString("openid");this.GetQueryString("userid");null==e?this.getOpenid():(uni.hideLoading(),this.openid=e,uni.setStorageSync("openid",e))},data:function(){var e=this;return{openid:"",inviter_id:"",border:!1,labelStyle:{fontSize:"28rpx",fontWeight:"bold"},labelPosition:"top",codeTips:"",errorType:["message","border-bottom"],model:{phone:"",code:""},rules:{phone:[{required:!0,message:"请输入手机号",trigger:["change","blur"]},{validator:function(t,o,n){return e.$u.test.mobile(o)},message:"手机号码不正确",trigger:["change","blur"]}],code:[]}}},onReady:function(){this.$refs.uForm.setRules(this.rules)},computed:{disabled:function(){var e=!0;return this.model.phone&&this.model.code&&(e=!1),e}},methods:{getOpenid:function(){console.log("eee"),window.location.href=this.http.interfaceUrl()+"auth/oauth?action=0"},codeChange:function(e){this.codeTips=e},getCode:function(){var e=this;if(!this.model.phone)return this.$u.toast("请先输入手机号码!");this.$refs.uCode.canGetCode?(uni.showLoading({title:"正在获取验证码",mask:!0}),this.http.post("auth/sendMsgCode",{tel_num:this.model.phone}).then((function(t){1e3==t.code?(uni.hideLoading(),e.$u.toast("验证码已发送"),e.$refs.uCode.start()):e.$u.toast(t.msg)}))):this.$u.toast("倒计时结束后再发送")},submit:function(){var e=this;this.$refs.uForm.validate((function(t){t?e.http.post("auth/login",{tel_num:e.model.phone,msg_code:e.model.code}).then((function(t){if(1e3===t.code)uni.setStorageSync("identity",t.data.identity),uni.setStorageSync("mobile",e.model.phone),e.http.setUserInfo(t.data.token),1===t.data.identity?e.$refs.uToast.show({title:t.msg,type:"success",isTab:!0,url:"/pages/home/home"}):2===t.data.identity||3===t.data.identity?window.location.href=e.http.navUrl()+"staff":4===t.data.identity||5===t.data.identity?window.location.href=e.http.navUrl()+"manager":6===t.data.identity&&(window.location.href=e.http.navUrl()+"manager/#/pages/leader/index?"+e.$u.random(1,100));else{if(uni.setStorageSync("mobile",e.model.phone),uni.setStorageSync("code",e.model.code),t.data.no_reg)return e.$u.route("/pages/login/register");e.$refs.uToast.show({title:t.msg,type:"error"}),"用户不存在"==t.msg&&setTimeout((function(){uni.navigateTo({url:"register"})}),1e3)}})):e.$refs.uToast.show({title:"请填写完带*号的选项再提交",type:"error"})}))},GetQueryString:function(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),o=window.location.search.substr(1).match(t);return null!=o?unescape(o[2]):null}}};t.default=n},ff65:function(e,t,o){"use strict";var n=o("25c8"),i=o.n(n);i.a}}]);